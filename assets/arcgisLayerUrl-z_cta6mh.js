import{I as u,ad as m,ae as o,af as c,ag as S,ah as g}from"./index-BdXiYUWp.js";const v={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},f=Object.values(v),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${f.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),w=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${f.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),y=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function b(r){return d.test(r)}function p(r){if(r==null)return null;const e=u(r),t=(e==null?void 0:e.path.match(d))||(e==null?void 0:e.path.match(w));if(!t)return null;const[,s,n,l,a]=t,i=n.indexOf("/");return{title:h(i!==-1?n.slice(i+1):n),serverType:v[l.toLowerCase()],sublayer:a!=null&&a!==""?parseInt(a,10):null,url:{path:s}}}function C(r){const e=u(r).path.match(y);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function h(r){return(r=r.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+r.slice(1)}function L(r,e){const t=[];if(r){const s=p(r);s!=null&&s.title&&t.push(s.title)}if(e){const s=h(e);t.push(s)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function $(r){let e=m(r,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function j(r,e){return r&&o(c(r,e))}function x(r){let{url:e}=r;if(!e)return{url:e};e=c(e,r.logger);const t=u(e),s=p(t.path);let n;if(s!=null)s.sublayer!=null&&r.layer.layerId==null&&(n=s.sublayer),e=s.url.path;else if(r.nonStandardUrlAllowed){const l=C(t.path);l!=null&&(e=l.serviceUrl,n=l.sublayerId)}return{url:o(e),layerId:n}}function U(r,e,t,s,n){S(e,s,"url",n),s.url&&r.layerId!=null&&(s.url=g(s.url,t,r.layerId.toString()))}function W(r){if(!r)return!1;const e=r.toLowerCase(),t=e.includes("/services/"),s=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),l=e.includes("/wmsserver");return t&&(s||n||l)}export{U as C,x as S,W as b,p as d,$ as g,C as h,h as m,b as p,L as w,j as y};
