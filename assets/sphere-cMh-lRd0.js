import{aG as h,bJ as I,dG as H,bB as L,dC as Q,bK as $}from"./index-DMwY2Yeh.js";import{p as U}from"./mat4-DsYZliz4.js";import{A as P,P as l,_ as b,r as f,s as A,c as g,u as w,g as d,o as C,v as W,p as Z,I as tt,j as nt,E as rt,q as it}from"./vec32-wPxsRdwz.js";import{a as E,L as z}from"./vec42-CwZz9wN3.js";import{n as B,r as F}from"./vec4f64-CMoMXWBi.js";import{e as et}from"./common-DokbeE9L.js";import"./mat3-BBgb1kkc.js";import"./mat3f64-q3fE-ZOt.js";import{c as a,f as ot}from"./plane-3MBkXSly.js";function Kt(t,r){return l(t,r)/f(t)}function st(t,r){const n=l(t,r)/(f(t)*f(r));return-I(n)}function Nt(t,r,n){P(p,t),P(y,r);const i=l(p,y),e=I(i),o=b(p,p,y);return l(o,n)<0?2*Math.PI-e:e}const p=h(),y=h();class ct{constructor(r){this._allocator=r,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&H(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const r=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*T);this._items.length=Math.min(r,this._items.length),this._itemsPtr=0}_grow(){for(let r=0;r<Math.max(8,Math.min(this._items.length,T));r++)this._items.push(this._allocator())}}const T=1024;function S(t){return t?k(L(t.origin),L(t.direction)):k(h(),h())}function k(t,r){return{origin:t,direction:r}}function Vt(t,r){const n=ht.get();return n.origin=t,n.direction=r,n}function Xt(t,r=S()){return at(t.origin,t.direction,r)}function ut(t,r,n=S()){return A(n.origin,t),g(n.direction,r,t),n}function at(t,r,n=S()){return A(n.origin,t),A(n.direction,r),n}function Yt(t,r){const n=b(a.get(),P(a.get(),t.direction),g(a.get(),r,t.origin));return l(n,n)}function ft(t,r,n){const i=l(t.direction,g(n,r,t.origin));return w(n,t.origin,d(n,t.direction,i)),n}const ht=new ct(()=>S());function G(t,r){const n=f(t),i=Q(t[2]/n),e=Math.atan2(t[1]/n,t[0]/n);return C(r,n,i,e),r}const gt=O();function O(){return B()}const mt=z,lt=z;function J(t,r){return E(r,t)}function _t(t,r){return F(t[0],t[1],t[2],r)}function dt(t){return t}function Mt(t){t[0]=t[1]=t[2]=t[3]=0}function pt(t,r){return t[0]=t[1]=t[2]=0,t[3]=r,t}function M(t){return t[3]}function $t(t){return t}function Pt(t,r,n,i){return F(t,r,n,i)}function bt(t,r,n){return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=t[3]+r,n}function qt(t,r,n){return t!==n&&J(t,n),n}function wt(t,r){return r}function x(t,r,n){if(r==null||!K(t,r,q))return!1;let{t0:i,t1:e}=q;if((i<0||e<i&&e>0)&&(i=e),i<0)return!1;if(n){const{origin:o,direction:s}=r;n[0]=o[0]+s[0]*i,n[1]=o[1]+s[1]*i,n[2]=o[2]+s[2]*i}return!0}function St(t,r,n){const i=ut(r,n);if(!K(t,i,q))return[];const{origin:e,direction:o}=i,{t0:s,t1:c}=q,u=m=>{const _=h();return it(_,e,o,m),j(t,_,_)};return Math.abs(s-c)<et()?[u(s)]:[u(s),u(c)]}const q={t0:0,t1:0};function K(t,r,n){const{origin:i,direction:e}=r,o=xt;o[0]=i[0]-t[0],o[1]=i[1]-t[1],o[2]=i[2]-t[2];const s=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(s===0)return!1;const c=2*(e[0]*o[0]+e[1]*o[1]+e[2]*o[2]),u=c*c-4*s*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(u<0)return!1;const m=Math.sqrt(u);return n.t0=(-c-m)/(2*s),n.t1=(-c+m)/(2*s),!0}const xt=h();function yt(t,r){return x(t,r,null)}function vt(t,r,n){if(x(t,r,n))return n;const i=N(t,r,a.get());return w(n,r.origin,d(a.get(),r.direction,Z(r.origin,i)/f(r.direction))),n}function N(t,r,n){const i=a.get(),e=ot.get();b(i,r.origin,r.direction);const o=M(t);b(n,i,r.origin),d(n,n,1/f(n)*o);const s=V(t,r.origin),c=st(r.origin,n);return U(e,c+s,i),rt(n,n,e),n}function At(t,r,n,i){const e=M(t),o=e*e,s=r+.5*Math.PI,c=n*n+o-2*Math.cos(s)*n*e,u=Math.sqrt(c),m=c-o;if(m<=0)return .5;const _=Math.sqrt(m),D=Math.acos(_/u)-Math.asin(e/(u/Math.sin(s)));return Math.min(1,(D+.5*i)/i)}function Ct(t,r,n){return x(t,r,n)?n:(ft(r,t,n),j(t,n,n))}function j(t,r,n){const i=g(a.get(),r,t),e=d(a.get(),i,t[3]/f(i));return w(n,e,t)}function Et(t,r){const n=g(a.get(),r,t),i=nt(n),e=t[3]*t[3];return Math.sqrt(Math.abs(i-e))}function V(t,r){const n=g(a.get(),r,t),i=f(n),e=M(t),o=e+Math.abs(e-i);return I(e/o)}const v=h();function X(t,r,n,i){const e=g(v,r,t);switch(n){case $.X:{const o=G(e,v)[2];return C(i,-Math.sin(o),Math.cos(o),0)}case $.Y:{const o=G(e,v),s=o[1],c=o[2],u=Math.sin(s);return C(i,-u*Math.cos(c),-u*Math.sin(c),Math.cos(s))}case $.Z:return P(i,e);default:return}}function Y(t,r){const n=g(R,r,t);return f(n)-t[3]}function Rt(t,r,n,i){const e=Y(t,r),o=X(t,r,$.Z,R),s=d(R,o,n-e);return w(i,r,s)}function It(t,r){const n=W(t,r),i=M(t);return n<=i*i}function Ot(t,r,n=B()){const i=Z(t,r),e=t[3],o=r[3];return i+o<e?(E(n,t),n):i+e<o?(E(n,r),n):(tt(n,t,r,(i+o-e)/(2*i)),n[3]=(i+e+o)/2,n)}const R=h(),jt=O(),Dt=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:gt,altitudeAt:Y,angleToSilhouette:V,axisAt:X,cameraFrustumCoverage:At,clear:Mt,closestPoint:Ct,closestPointOnSilhouette:N,containsPoint:It,copy:J,create:O,distanceToSilhouette:Et,elevate:bt,equals:lt,exactEquals:mt,fromCenterAndRadius:_t,fromRadius:pt,fromValues:Pt,getCenter:$t,getExtent:wt,getRadius:M,intersectLine:St,intersectRay:x,intersectRayClosestSilhouette:vt,intersectsRay:yt,projectPoint:j,setAltitudeAt:Rt,setExtent:qt,tmpSphere:jt,union:Ot,wrap:dt},Symbol.toStringTag,{value:"Module"}));export{O as E,yt as H,M as N,dt as T,$t as U,Pt as V,J as a,S as b,Dt as c,Kt as f,It as i,Vt as k,ct as s,Nt as u,Xt as v,Yt as w};
