import{P as I,X as i,Z as s,cD as f,a2 as b,U as m,e2 as j,e3 as g}from"./index-BdXiYUWp.js";import{t as x}from"./query-CpvlvXmT.js";import"./normalizeUtils-BACmLuYb.js";import"./normalizeUtilsCommon-DnAXcLGn.js";import"./utils-Bh8BC7JY.js";import"./utils-BllU-TlI.js";import"./pbfQueryUtils-Cv7uCooV.js";import"./pbf-PJcJHQe7.js";import"./OptimizedFeature-D3320lj0.js";import"./OptimizedFeatureSet-Blu9Ckm7.js";import"./queryZScale-DeuR5Lm5.js";import"./zscale-Q26ExEVF.js";function v(e){const{exifInfo:t,exifName:o,tagName:n}=e;if(!t)return null;const r=t.find(l=>l.name===o);return r?O({tagName:n,tags:r.tags}):null}function O(e){const{tagName:t,tags:o}=e;if(!o)return null;const n=o.find(r=>r.name===t);return(n==null?void 0:n.value)||null}var u;const $={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let a=u=class extends I{constructor(e){super(e),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:e}=this,t=v({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:e});return $[t]||null}clone(){return new u({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};i([s({type:String})],a.prototype,"contentType",void 0),i([s()],a.prototype,"exifInfo",void 0),i([s({readOnly:!0})],a.prototype,"orientationInfo",null),i([s({type:f})],a.prototype,"id",void 0),i([s({type:String})],a.prototype,"globalId",void 0),i([s({type:String})],a.prototype,"keywords",void 0),i([s({type:String})],a.prototype,"name",void 0),i([s({json:{read:!1}})],a.prototype,"parentGlobalId",void 0),i([s({json:{read:!1}})],a.prototype,"parentObjectId",void 0),i([s({type:f})],a.prototype,"size",void 0),i([s({json:{read:!1}})],a.prototype,"url",void 0),a=u=i([b("esri.rest.query.support.AttachmentInfo")],a);const w=a;function N(e){const t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function F(e,t){const o={};for(const n of t){const{parentObjectId:r,parentGlobalId:l,attachmentInfos:d}=n;for(const p of d){const{id:h}=p,y=j(g(`${e.path}/${r}/attachments/${h}`)),c=w.fromJSON(p);c.set({url:y,parentObjectId:r,parentGlobalId:l}),o[r]?o[r].push(c):o[r]=[c]}}return o}function R(e,t,o){let n={query:x({...e.query,f:"json",...N(t)})};return o&&(n={...o,...n,query:{...o.query,...n.query}}),m(e.path+"/queryAttachments",n).then(r=>r.data.attachmentGroups)}async function U(e,t,o){const{objectIds:n}=t,r=[];for(const l of n)r.push(m(e.path+"/"+l+"/attachments",o));return Promise.all(r).then(l=>n.map((d,p)=>({parentObjectId:d,attachmentInfos:l[p].data.attachmentInfos})))}export{R as executeAttachmentQuery,U as fetchAttachments,F as processAttachmentQueryResult};
