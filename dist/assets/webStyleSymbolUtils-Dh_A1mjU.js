import{b as N,I as y,s as D,p as h,R as U,x as I,c as d,i as S}from"./index-BdXiYUWp.js";import{c as v,a as w}from"./devEnvironmentUtils-CnNDiFMM.js";import{p as P,m as j,a as O,i as A,y as E,h as M}from"./styleUtils-CV5RL6ze.js";import"./layerUtils-CRmrchQW.js";import"./defaults-C0xTDeSo.js";import"./defaultsJSON-GKolV7NZ.js";function J(t,e,l,n){const r=t.name;return r==null?Promise.reject(new D("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?k(r,e,n):A(t,e,n).then(o=>W(o,r,e,l,E,n))}function T(t,e){return e.items.find(l=>l.name===t)}function W(t,e,l,n,r,o){var c,g;const s=(l==null?void 0:l.portal)!=null?l.portal:N.getDefault(),b={portal:s,url:y(t.baseUrl)},m=T(e,t.data);if(!m){const u=`The symbol name '${e}' could not be found`;return Promise.reject(new D("symbolstyleutils:symbol-name-not-found",u,{symbolName:e}))}let i=h(r(m,n),b),p=((c=m.thumbnail)==null?void 0:c.href)??null;const f=(g=m.thumbnail)==null?void 0:g.imageData;v()&&(i=w(i)??"",p=w(p));const R={portal:s,url:y(U(i)),origin:"portal-item"};return P(i,o).then(u=>{const x=n==="cimRef"?j(u.data):u.data,a=O(x,R);if(a&&I(a)){if(p){const F=h(p,b);a.thumbnail=new d({url:F})}else f&&(a.thumbnail=new d({url:`data:image/png;base64,${f}`}));t.styleUrl?a.styleOrigin=new S({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(a.styleOrigin=new S({portal:l.portal,styleName:t.styleName,name:e}))}return a})}function k(t,e,l){const n=M.replaceAll(/\{SymbolName\}/gi,t),r=e.portal!=null?e.portal:N.getDefault();return P(n,l).then(o=>{const s=j(o.data);return O(s,{portal:r,url:y(U(n)),origin:"portal-item"})})}export{W as fetchSymbolFromStyle,T as getStyleItemFromStyle,J as resolveWebStyleSymbol};
